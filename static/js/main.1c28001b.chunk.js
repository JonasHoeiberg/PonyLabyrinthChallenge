(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{10:function(e,t,n){e.exports=n(27)},15:function(e,t,n){},19:function(e,t,n){},21:function(e,t,n){},23:function(e,t,n){},25:function(e,t,n){},27:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(9),o=n.n(i),s=(n(15),n(2)),l=n.n(s),u=n(7),c=n(1),h=n(3),p=n(5),d=n(4),f=n(6);n(19),n(21);function m(e,t){null==t&&(t=!1);var n=Object.keys(e).reduce(function(n,a){var r=a.match(/(^[^A-Z]+)|([A-Z][^A-Z]+)/g).reduce(function(e,t,n){return 0!==n&&(e+="-"),(e+=t).toLowerCase()},"");return n[r]=e[a],"object"===typeof n[r]&&!Array.isArray(n[r])&&t&&(n[r]=m(n[r])),n},{});return Object.assign({},n)}function v(e,t){var n=Object.keys(e).reduce(function(n,a){var r=a.match(/(^[^-]+)|(-[^-]+)/g).reduce(function(e,t,n){return 0!==n&&(t=t[1].toUpperCase()+t.slice(2)),e+=t},"");return n[r]=e[a],"object"===typeof n[r]&&!Array.isArray(n[r])&&t&&(n[r]=v(n[r])),n},{});return Object.assign({},n)}var g=Symbol.iterator,y=function(){function e(t){Object(c.a)(this,e),this.values=[],this.top=0,Array.isArray(t)&&(this.values=t)}return Object(h.a)(e,[{key:"dequeue",value:function(){var t=this.values[this.top];return null==t?null:(this.top++,this.top>e.TOP_MAX&&(this.values=this.values.splice(this.top),this.top=0),t)}},{key:"enqueue",value:function(e){this.values.push(e)}},{key:g,value:function(){return this.values}},{key:"length",get:function(){return this.values.length-this.top}},{key:"empty",get:function(){return 0===this.length}}]),e}();y.TOP_MAX=100;var b=function e(){Object(c.a)(this,e),this.edges=[],this.properties=[],this.parentNode=null,this.parentEdge=null};var w=function(){function e(){Object(c.a)(this,e),this.nodes=[]}return Object(h.a)(e,null,[{key:"fromMaze",value:function(t){var n=t.size[0],a=(t.size[1],t.data),r=t.pony[0],i=t.domokun[0],o=t.endPoint[0],s=new e;return s.nodes=a.map(function(e){return new b}),s.nodes.forEach(function(e,t){if(e.properties=[],t===r&&e.properties.push("pony"),t===i&&e.properties.push("domokun"),t===o&&e.properties.push("endPoint"),null!=s.nodes[t-1]){var a={label:"west",node:s.nodes[t-1]};e.edges.push(a)}if(null!=s.nodes[t+1]){var l={label:"east",node:s.nodes[t+1]};e.edges.push(l)}if(null!=s.nodes[t+n]){var u={label:"south",node:s.nodes[t+n]};e.edges.push(u)}if(null!=s.nodes[t-n]){var c={label:"north",node:s.nodes[t-n]};e.edges.push(c)}}),a.forEach(function(e,t){var n=s.nodes[t];e.forEach(function(e){var t=n.edges.findIndex(function(t){return t.label===e});if(-1!==t){var a=n.edges[t].node,r=a.edges.findIndex(function(e){return e.node===n});n.edges.splice(t,1),-1!==r&&a.edges.splice(r,1)}})}),s}}]),e}(),k=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(p.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={mazePlayerName:"Twilight Sparkle",mazeWidth:15,mazeHeight:15,difficulty:1,maze_id:void 0},n}return Object(f.a)(t,e),Object(h.a)(t,[{key:"getMazeId",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,n,a,r,i;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(t=this.state.maze_id)&&""!==t){e.next=16;break}return delete(n=m(this.state)).maze_id,n["maze-height"]=parseInt(n["maze-height"]),n["maze-width"]=parseInt(n["maze-height"]),a=new Request("https://ponychallenge.trustpilot.com/pony-challenge/maze",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(n)}),e.next=9,fetch(a);case 9:if(200===(r=e.sent).status){e.next=12;break}throw new Error("Something went wrong with the remote server");case 12:return e.next=14,r.json();case 14:i=e.sent,t=i.maze_id;case 16:this.setState({maze_id:t});case 17:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=["Twilight Sparkle"].map(function(e){return r.a.createElement("option",{value:e},e)});return r.a.createElement("form",null,r.a.createElement("label",{className:"LabyrinthOptionRow"},"Maze ID:",r.a.createElement("input",{type:"text",value:this.state.maze_id,onChange:function(t){return e.setState({maze_id:t.target.value})}})),"OR",r.a.createElement("br",null),r.a.createElement("label",null,"Pony:",r.a.createElement("select",{value:this.state.ponyName,onChange:function(t){return e.setState({ponyName:t.target.value})}},t)),r.a.createElement("label",{className:"LabyrinthOptionRow"},"Maze width:",r.a.createElement("input",{type:"number",min:"15",max:"25",value:this.state.mazeWidth,onChange:function(t){return e.setState({mazeWidth:t.target.value})}})),r.a.createElement("label",{className:"LabyrinthOptionRow"},"Maze height:",r.a.createElement("input",{type:"number",min:"15",max:"25",value:this.state.mazeHeight,onChange:function(t){return e.setState({mazeHeight:t.target.value})}})),r.a.createElement("label",{className:"LabyrinthOptionRow"},"Difficulty:",r.a.createElement("input",{type:"number",min:"0",max:"10",value:this.state.difficulty,onChange:function(t){return e.setState({difficulty:parseInt(t.target.value)})}})),r.a.createElement("input",{type:"button",value:null==this.state.maze_id||""===this.state.maze_id?"Generate maze":"Get maze",onClick:Object(u.a)(l.a.mark(function t(){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getMazeId();case 2:e.props.generateMaze(e.state.maze_id);case 3:case"end":return t.stop()}},t,this)}))}))}}]),t}(a.Component),z=(n(23),function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(p.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).cellWidth=20,n.width=10,n.height=10,n}return Object(f.a)(t,e),Object(h.a)(t,[{key:"renderMazeCells",value:function(){for(var e=[],t=0;t<this.width;t++)for(var n=0;n<this.height;n++){var a=this.props.maze.nodes[n+this.width*t];-1!==a.properties.indexOf("endPoint")?e.push(this.renderEndPointCell(n,t,a)):-1!==a.properties.indexOf("pony")?e.push(this.renderPonyCell(n,t,a)):-1!==a.properties.indexOf("domokun")?e.push(this.renderDomokunCell(n,t,a)):-1!==a.properties.indexOf("solution")&&this.props.showSolution?e.push(this.renderSolutionCell(n,t,a)):e.push(this.renderBasicCell(n,t,a))}return e}},{key:"renderPonyCell",value:function(e,t,n){return this.renderBasicCell(e,t,n,"Pony","P")}},{key:"renderDomokunCell",value:function(e,t,n){return this.renderBasicCell(e,t,n,"Domokun","D")}},{key:"renderEndPointCell",value:function(e,t,n){return this.renderBasicCell(e,t,n,"End","E")}},{key:"renderSolutionCell",value:function(e,t,n){return this.renderBasicCell(e,t,n,"Solution")}},{key:"renderBasicCell",value:function(e,t,n,a,i){null==i&&(i="");var o=this.cellWidth,s=this.cellWidth,l=e*this.cellWidth,u=t*this.cellWidth,c=[];n.edges.forEach(function(e){switch(e.label){case"north":c.push("N"),s++;break;case"west":c.push("W"),o++;break;case"east":c.push("E"),o++;break;case"south":c.push("S"),s++}});var h=c.reduce(function(e,t,n){return e+" "+t},"MazeCell"),p={width:o.toString()+"px",height:s.toString()+"px",left:l.toString()+"px",top:u.toString()+"px"};return null!=a&&(h+=" "+a),r.a.createElement("div",{className:h,style:p},i)}},{key:"getContainerStyle",value:function(){return{width:(this.cellWidth*this.width).toString()+"px",height:(this.cellWidth*this.height).toString()+"px"}}},{key:"render",value:function(){return null==this.props.maze?r.a.createElement("div",null):(this.width=this.props.width,this.height=this.props.height,r.a.createElement("div",{className:"MazeVisualization",style:this.getContainerStyle()},this.renderMazeCells()))}}]),t}(a.Component)),S=(n(25),function(e){function t(){return Object(c.a)(this,t),Object(p.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this,t=[];null!=this.props.currentNode&&((t=this.props.currentNode.edges.map(function(e){return e.label})).push("stay"),this.props.solutionFound&&(t.push("toggleSolution"),t.push("executeSolution"),t.push("executeOneMove")));return r.a.createElement("div",{className:"ControlContainer"},[{value:"north",label:"N"},{value:"south",label:"S"},{value:"east",label:"E"},{value:"west",label:"W"},{value:"stay",label:"X"},{value:"toggleSolution",label:"Toggle solution"},{value:"executeSolution",label:"Run solution"},{value:"executeOneMove",label:"Make optimal move"}].map(function(n){return r.a.createElement("input",{type:"button",className:n.value+"Button ControlButton",value:n.label,onClick:function(){return e.props.handleControl(n.value)},disabled:!t.some(function(e){return e===n.value})})}))}}]),t}(a.Component)),x=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(p.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={mazeHeight:null,mazeWidth:null,maze_id:null,labyrinthState:null,showSolution:!1,resultImage:null,solution:null},n}return Object(f.a)(t,e),Object(h.a)(t,[{key:"fetchMaze",value:function(){var e=Object(u.a)(l.a.mark(function e(t){var n,a,r,i;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Request("https://ponychallenge.trustpilot.com/pony-challenge/maze/"+t.toString(),{method:"GET",headers:{Accept:"application/json"}}),e.next=3,fetch(n);case 3:if(200===(a=e.sent).status){e.next=6;break}throw new Error("Something went wrong when fecthing maze");case 6:return e.t0=v,e.next=9,a.json();case 9:if(e.t1=e.sent,"active"===(r=(0,e.t0)(e.t1,!0)).gameState.state.toLowerCase()){e.next=14;break}return this.setState({resultImage:r.gameState.hiddenUrl}),e.abrupt("return");case 14:i=this.generateGraph(r),this.generateSolution(i),this.setState({mazeWidth:r.size[0],mazeHeight:r.size[1],maze_id:r.maze_id,labyrinthState:i});case 17:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"handleControl",value:function(){var e=Object(u.a)(l.a.mark(function e(t){var n,a,r,i,o,s;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.state.labyrinthState&&null!=this.state.maze_id){e.next=2;break}return e.abrupt("return");case 2:if("toggleSolution"!==t){e.next=6;break}this.setState({showSolution:!this.state.showSolution}),e.next=52;break;case 6:if("executeOneMove"!==t){e.next=13;break}if(null==this.state.solution){e.next=11;break}return e.next=10,this.makeMove(this.state.solution[0].edge.label);case 10:this.fetchMaze(this.state.maze_id.toString());case 11:e.next=52;break;case 13:if("executeSolution"!==t){e.next=49;break}if(null==this.state.solution){e.next=47;break}n=!0,a=!1,r=void 0,e.prev=18,i=this.state.solution[Symbol.iterator]();case 20:if(n=(o=i.next()).done){e.next=32;break}return s=o.value,e.t0=v,e.next=25,this.makeMove(s.edge.label);case 25:if(e.t1=e.sent,"active"===(0,e.t0)(e.t1).state.toLowerCase()){e.next=29;break}return e.abrupt("break",32);case 29:n=!0,e.next=20;break;case 32:e.next=38;break;case 34:e.prev=34,e.t2=e.catch(18),a=!0,r=e.t2;case 38:e.prev=38,e.prev=39,n||null==i.return||i.return();case 41:if(e.prev=41,!a){e.next=44;break}throw r;case 44:return e.finish(41);case 45:return e.finish(38);case 46:this.fetchMaze(this.state.maze_id);case 47:e.next=52;break;case 49:return e.next=51,this.makeMove(t);case 51:this.fetchMaze(this.state.maze_id.toString());case 52:case"end":return e.stop()}},e,this,[[18,34,38,46],[39,,41,45]])}));return function(t){return e.apply(this,arguments)}}()},{key:"makeMove",value:function(){var e=Object(u.a)(l.a.mark(function e(t){var n,a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Request("https://ponychallenge.trustpilot.com/pony-challenge/maze/"+this.state.maze_id.toString(),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({direction:t})}),e.next=3,fetch(n);case 3:return a=e.sent,e.abrupt("return",a.json());case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"generateSolution",value:function(e){e.nodes.forEach(function(e){return e.properties.filter(function(e){return"solution"!==e.solution})});var t=function(e,t,n,a){if(null!=a&&"function"!==typeof a)throw new Error("validNode must be null or a function");t.parentNode=-1,t.parentEdge=-1;var r=new y;for(r.enqueue(t);!r.empty;){var i=r.dequeue();if(i===n)break;var o=!0,s=!1,l=void 0;try{for(var u,c=i.edges[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var h=u.value;null!=h.node.parentNode||null!=a&&!a(h.node)||(h.node.parentNode=i,h.node.parentEdge=h,r.enqueue(h.node))}}catch(k){s=!0,l=k}finally{try{o||null==c.return||c.return()}finally{if(s)throw l}}}var p=[];if(null==n.parentNode)p=null;else for(var d=n;-1!==d.parentNode;)p.push({node:d,edge:d.parentEdge}),d=d.parentNode;var f=!0,m=!1,v=void 0;try{for(var g,b=e.nodes[Symbol.iterator]();!(f=(g=b.next()).done);f=!0){var w=g.value;w.parentNode=null,w.parentEdge=null}}catch(k){m=!0,v=k}finally{try{f||null==b.return||b.return()}finally{if(m)throw v}}return p}(e,e.nodes.find(function(e){return e.properties.some(function(e){return"pony"===e})}),e.nodes.find(function(e){return e.properties.some(function(e){return"endPoint"===e})}),function(e){return e.properties.every(function(e){return"domokun"!==e})});null!=t&&(t=t.reverse()).forEach(function(e){e.node.properties.some(function(e){return"solution"===e})||e.node.properties.push("solution")}),this.setState({solution:t})}},{key:"generateGraph",value:function(e){return w.fromMaze(e)}},{key:"render",value:function(){var e=this;if(null!==this.state.resultImage)return r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},r.a.createElement("img",{src:"https://ponychallenge.trustpilot.com"+this.state.resultImage}),r.a.createElement("input",{type:"button",value:"Refresh",onClick:function(){return e.setState({mazeHeight:null,mazeWidth:null,maze_id:null,labyrinthState:null,showSolution:!1,resultImage:null})}})));var t=null;return null!=this.state.labyrinthState&&(t=this.state.labyrinthState.nodes.find(function(e){return-1!==e.properties.indexOf("pony")})),r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header AppContainer"},r.a.createElement(k,{className:"MazeElement",generateMaze:function(t){return e.fetchMaze(t)}}),r.a.createElement(z,{className:"MazeElement",maze:this.state.labyrinthState,showSolution:this.state.showSolution,width:this.state.mazeWidth,height:this.state.mazeHeight}),r.a.createElement(S,{className:"MazeElement",currentNode:t,handleControl:function(t){return e.handleControl(t)},solutionFound:null!=this.state.solution})))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(x,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[10,2,1]]]);
//# sourceMappingURL=main.1c28001b.chunk.js.map